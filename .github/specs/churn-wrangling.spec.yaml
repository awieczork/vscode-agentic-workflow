# Spec: churn-wrangling (skill)
# Generated by @interviewer from Churn Usage Analysis seed

artifact_type: skill
spec_version: 1
name: churn-wrangling
purpose: "Repeatable 6-step pipeline for pulling Pendo usage data from Redshift, cleaning, joining to ERP records, deriving churn labels, aggregating to customer level, and handling missing data"
domain: data-science
priority: P1

capabilities:
  - "pull Pendo usage data from Redshift via SQL and load into R"
  - "clean and standardize Pendo usage columns (time on app, days active, events)"
  - "join Pendo data to ERP records by customer/user ID"
  - "derive churn labels from ERP data using user-defined churn logic"
  - "aggregate user-level data to customer-level summaries"
  - "detect, report, and handle missing data and outliers"

complexity_signals:
  - "needs SQL query templates for Redshift data pull"
  - "has decision rules for churn label derivation (user-defined business logic)"
  - "requires join-key validation between Pendo and ERP datasets"
  - "needs data quality checks at multiple pipeline stages"

step_count: 6
error_modes:
  - "Redshift connection or query fails — SQL syntax error or timeout"
  - "join key mismatch — Pendo user IDs do not match ERP customer IDs"
  - "churn label derivation rule not defined — cannot proceed without user input"
  - "missing data exceeds threshold — too many NAs to produce reliable output"
  - "data type mismatch after join — numeric columns read as character"

tech:
  languages: [R, SQL]
  frameworks: [tidyverse]
  tools: [Redshift]

sources:
  - url: "https://rstudio.github.io/cheatsheets/html/tidyr.html"
    about: "Data tidying with tidyr"
    relevance: "Reshaping and cleaning patterns for the data preparation steps"
  - url: "https://rstudio.github.io/cheatsheets/html/data-transformation.html"
    about: "Data transformation with dplyr"
    relevance: "Join operations, aggregation, and mutation for the pipeline steps"

concepts:
  - name: "Pendo-to-ERP mapping"
    relevance: "Core pain point — joining product analytics (Pendo) to business system (ERP) data by customer/user ID"
  - name: "churn label derivation"
    relevance: "Business rule that defines when a customer is churned — must come from user, never assumed"
  - name: "customer-level aggregation"
    relevance: "Pendo data is user-level; analysis needs customer-level summaries"

folder_structure:
  - "references/"
reference_files:
  - "pipeline-steps.md"
loading_strategy: "Eager for pipeline step definitions, JIT for SQL templates"

interviewer_notes: >
  User's primary pain point is the Pendo→ERP data mapping. This skill covers the full data pipeline
  from raw Redshift pull to analysis-ready customer-level dataset with churn labels.
  All 6 steps selected by user. Churn label derivation requires user-defined business logic —
  the skill must never assume a churn definition. Currently at early stage: has Pendo data mapped
  to ERP ID but churn labels not yet connected. This skill directly addresses that gap.
